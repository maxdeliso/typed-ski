module Test

import Lexer tokenizeBin
import Lexer tokenizeAcc
import Lexer Token
import Lexer reverse
import Prelude Bin
import Prelude incBin
import Prelude nil
import Prelude cons
import Prelude foldl
import Prelude Result
import Prelude Err
import Prelude Ok
import Prelude ParseError
import Prelude List
import Nat fromBin
import Nat Nat

export main

poly rec length = \xs : List Token =>
  foldl [Token] [Bin]
    (\acc : Bin => \_ : Token => incBin acc)
    0
    xs

poly main =
  match (tokenizeBin "1 2") [Nat] {
    | Err _ => 0
    | Ok tokens => fromBin (length tokens)
  }
