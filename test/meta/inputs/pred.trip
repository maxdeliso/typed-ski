module Pred

type Nat = #X -> (X -> X) -> X -> X

poly zero  = #X => \s : X -> X => \z : X => z
poly succ  = \n : Nat =>
               #a => \s : a -> a => \z : a =>
                 s (n[a] s z)

poly one   = succ zero
poly two   = succ one
poly three = succ two

poly pair = #A => #B =>
              \a : A => \b : B =>
              #Y => \k : A -> B -> Y =>
                k a b

poly fst = #A => #B =>
             \p : #Y -> (A -> B -> Y) -> Y =>
               p [A] (\x : A => \y : B => x)

poly snd = #A => #B =>
             \p : #Y -> (A -> B -> Y) -> Y =>
               p [B] (\x : A => \y : B => y)

poly pred = \n : Nat =>
  fst Nat Nat
    ( n [#Y -> (Nat -> Nat -> Y) -> Y]
      ( \p : #Y -> (Nat -> Nat -> Y) -> Y =>
          pair Nat Nat
            (snd Nat Nat p)
            (succ (snd Nat Nat p))
      )
      (pair Nat Nat zero zero)
    )

poly testPred1 = pred one
poly testPred3 = pred three
poly testPair = pair Nat Nat two three
poly testFst  = fst Nat Nat testPair
poly testSnd  = snd Nat Nat testPair
poly main = succ (pred three)
